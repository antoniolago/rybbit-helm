# name: Trigger on Rybbit Release

# on:
#   release:
#     types: [published]
#   workflow_dispatch:
#     inputs:
#       version:
#         description: 'Version tag to test'
#         required: true
#         default: 'latest'

# jobs:
#   trigger-helm-test:
#     name: Trigger Helm Chart Test
#     runs-on: ubuntu-latest
#     steps:
#       - name: Get release version
#         id: version
#         run: |
#           if [ "${{ github.event_name }}" = "release" ]; then
#             VERSION="${{ github.event.release.tag_name }}"
#           else
#             VERSION="${{ github.event.inputs.version }}"
#           fi
#           echo "version=$VERSION" >> $GITHUB_OUTPUT
#           echo "Testing Helm chart with Rybbit version: $VERSION"

#       - name: Trigger Helm chart tests
#         uses: peter-evans/repository-dispatch@v3
#         with:
#           token: ${{ secrets.HELM_REPO_TOKEN }}
#           repository: antoniolago/rybbit-helm
#           event-type: rybbit-release
#           client-payload: '{"version": "${{ steps.version.outputs.version }}", "ref": "${{ github.sha }}"}'

#       - name: Summary
#         run: |
#           echo "## Helm Chart Test Triggered" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "- **Version**: ${{ steps.version.outputs.version }}" >> $GITHUB_STEP_SUMMARY
#           echo "- **Commit**: ${{ github.sha }}" >> $GITHUB_STEP_SUMMARY
#           echo "- **Triggered by**: ${{ github.actor }}" >> $GITHUB_STEP_SUMMARY
